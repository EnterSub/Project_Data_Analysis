#Copyright (c) Dmitry Moskalev
ScreenManager:

    MDScreen:
        name: 'login'
        md_bg_color: app.theme_cls.bg_light
        on_pre_enter:
            image2.anim_delay = -1
            image3.anim_delay = -1

        MDFloatLayout:

            Image:
                id: image1
                source: "login.gif"
                anim_delay: 1/24
                pos_hint: {"x": 0, "y": 0.23}

            MDLabel:
                font_style: "H6"
                text: "Authentication"
                pos_hint: {"center_x": .5, "center_y": .46}
                valign: 'middle'
                halign: 'center'

            MDFloatLayout:
                size_hint_x: .95
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .38}

                MDTextField:
                    id: user
                    text_color_focus: 0,0,0,1
                    color_mode: "custom"
                    mode: "fill"
                    hint_text: "Username"
                    size_hint_x: 1
                    size_hint_y: None
                    icon_right: "account"
                    pos_hint: {"center_x": .5, "center_y": .5}
                    height: self.minimum_height
                    multiline: False

            MDFloatLayout:
                size_hint_x: .95
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .27}

                MDTextField:
                    id: password
                    text_color_focus: 0,0,0,1
                    color_mode: "custom"
                    mode: "fill"
                    hint_text: "Password"
                    password: True
                    size_hint_x: 1
                    size_hint_y: None
                    icon_right: "key"
                    pos_hint: {"center_x": .5, "center_y": .5}
                    height: self.minimum_height
                    multiline: False

            MDTextButton:
                font_style: "Overline"
                text: "Forgot your password?"
                pos_hint: {"center_x": .5, "center_y": .2}
                on_press: app.show_information()

            MDFillRoundFlatButton:
                font_style: "Button"
                text: "Login"
                size_hint_x: .75
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .14}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press:
                    root.transition.direction = 'right'
                    app.start()

            MDFillRoundFlatButton:
                font_style: "Button"
                text: "Close"
                size_hint_x: .25
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .05}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press: app.stop()

    MDScreen:
        name: 'manual_load'
        md_bg_color: app.theme_cls.bg_light
        on_pre_enter: root.ids.file.text = 'Html file: '

        MDLabel:
            font_style: "Subtitle1"
            text: 'Choose file'
            valign: 'middle'
            halign: 'center'
            pos_hint: {"center_x": .5, "center_y": .9}

        MDFillRoundFlatIconButton:
            font_style: "Button"
            icon: "file"
            text: "Open manager"
            size_hint_x: .75
            size_hint_y: None
            pos_hint: {'center_x': .5, 'center_y': .8}
            md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
            on_press:
                app.file_manager_open()

        MDLabel:
            id: file
            text: f'Html file: '
            font_style: "Subtitle1"
            valign: 'middle'
            halign: 'center'
            pos_hint: {"center_x": .5, "center_y": .32}

        MDFillRoundFlatButton:
            font_style: "Button"
            text: "OK"
            size_hint_x: .75
            size_hint_y: None
            pos_hint: {'center_x':.5,'center_y':.14}
            md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
            on_press:
                root.transition.direction = 'right'
                app.show_data()
                root.current = 'subjects'

        MDFillRoundFlatButton:
            font_style: "Button"
            text: 'Back'
            size_hint_x: .25
            size_hint_y: None
            pos_hint: {'center_x':.5,'center_y':.05}
            md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
            on_press:
                root.transition.direction = 'right'
                root.current = 'login'

    MDScreen:
        name: 'menu'
        md_bg_color: app.theme_cls.bg_light
        on_pre_enter:
            image2.anim_delay = 1/30

        MDFloatLayout:

            Image:
                id: image2
                source: "process.gif"
                pos_hint: {"x": 0, "y": .23}

            MDFloatLayout:
                size_hint_x: .95
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .38}

                MDTextField:
                    id: textbox
                    text_color_focus: 0,0,0,1
                    color_mode: "custom"
                    mode: "fill"
                    hint_text: "Enter group name"
                    required: True
                    error_color: 'brown'
                    #helper_text: "Enter value to process student's activity"
                    #helper_text_mode: "on_error"
                    icon_right: "account-group"
                    pos_hint: {'center_x': .5, 'center_y': .5}
                    size_hint_x: 1
                    size_hint_y: None
                    multiline: False
                    max_text_length: 10

            MDFloatLayout:
                size_hint_x: .95
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .27}

                MDTextField:
                    id: textbox_week_number
                    text_color_focus: 0,0,0,1
                    color_mode: "custom"
                    mode: "fill"
                    hint_text: 'Enter week number'
                    required: False
                    error_color: 'brown'
                    #helper_text: 'Enter week number'
                    #helper_text_mode: "on_error"
                    icon_right: "calendar-blank"
                    pos_hint: {'center_x': .5, 'center_y': .5}
                    size_hint_x: 1
                    size_hint_y: None
                    multiline: False
                    max_text_length: 2

            MDFillRoundFlatButton:
                font_style: "Button"
                text: "OK"
                size_hint_x: .75
                size_hint_y: None
                pos_hint: {'center_x':.5,'center_y':.14}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press:
                    root.transition.direction = 'right'
                    app.show_data()
                    root.current = 'subjects'

            MDFillRoundFlatButton:
                font_style: "Button"
                text: "Back"
                size_hint_x: .25
                size_hint_y: None
                pos_hint: {'center_x':.5,'center_y':.05}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press:
                    root.transition.direction = 'right'
                    root.current = 'login'

    MDScreen:
        id: data_subjects
        name: 'subjects'
        md_bg_color: app.theme_cls.bg_light
        on_pre_enter:
            image2.anim_delay = -1
            image4.anim_delay = -1
            image4.anim_loop = 0

        MDBoxLayout:
            orientation: "vertical"
            size_hint_x: 1
            adaptive_height: True
            pos_hint: {"center_x": .5, "center_y": .5}
            md_bg_color: app.theme_cls.bg_light

            MDBoxLayout:
                id: subjects_box
                size_hint_x: 1
                adaptive_height: True
                pos_hint: {"center_x": .5, "center_y": .5}
                md_bg_color: app.theme_cls.bg_light

            MDBoxLayout:
                orientation: "vertical"
                adaptive_height: True
                pos_hint: {"center_x": .5, "center_y": .5}
                md_bg_color: app.theme_cls.bg_light

                MDBoxLayout:
                    orientation: "horizontal"
                    adaptive_height: True
                    pos_hint: {"center_x": .5, "center_y": .5}
                    md_bg_color: app.theme_cls.bg_light

                    MDFillRoundFlatButton:
                        font_style: "Button"
                        text: "Back"
                        size_hint_x: .5
                        size_hint_y: None
                        pos_hint: {"center_x": .25, "center_y": .5}
                        md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                        on_press:
                            root.transition.direction = 'right'
                            root.current = 'login'

                    MDFillRoundFlatButton:
                        font_style: "Button"
                        text: "OK"
                        size_hint_x: .5
                        size_hint_y: None
                        pos_hint: {"center_x": .75, "center_y": .5}
                        md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                        on_press:
                            root.transition.direction = 'right'
                            root.current = 'processing'

    MDScreen:
        name: 'processing'
        md_bg_color: app.theme_cls.bg_light
        on_pre_enter:
            image3.anim_delay = 1/30
            root.ids.file1.text = '1 file: '
            root.ids.file2.text = '2 file: '

        MDFloatLayout:

            Image:
                id: image3
                source: "manager.gif"
                pos_hint: {"x": 0, "y": 0.1}

            MDLabel:
                font_style: "Subtitle1"
                text: 'Please provide images'
                valign: 'middle'
                halign: 'center'
                pos_hint: {"center_x": .5, "center_y": .9}

            MDFillRoundFlatIconButton:
                font_style: "Button"
                icon: "file"
                text: "Open manager"
                size_hint_x: .75
                size_hint_y: None
                pos_hint: {'center_x': .5, 'center_y': .8}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press: app.file_manager_open()

            MDLabel:
                id: file1
                text: f'1 file: '
                font_style: "Subtitle1"
                valign: 'middle'
                halign: 'center'
                pos_hint: {"center_x": .5, "center_y": .32}

            MDLabel:
                id: file2
                text: f'2 file: '
                font_style: "Subtitle1"
                valign: 'middle'
                halign: 'center'
                pos_hint: {"center_x": .5, "center_y": .23}

            MDFillRoundFlatButton:
                id: button_processing
                font_style: "Button"
                text: "OK"
                size_hint_x: .75
                size_hint_y: None
                pos_hint: {'center_x':.5,'center_y':.14}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press:
                    root.transition.direction = 'right'
                    root.current = 'table'
                    app.show_table()

            MDFillRoundFlatButton:
                font_style: "Button"
                text: 'Back'
                size_hint_x: .25
                size_hint_y: None
                pos_hint: {'center_x':.5,'center_y':.05}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press:
                    root.transition.direction = 'right'
                    root.current = 'subjects'

    MDScreen:
        id: data_scr
        name: 'table'
        md_bg_color: app.theme_cls.bg_light
        on_pre_enter:
            image3.anim_delay = -1

        MDBoxLayout:
            orientation: "vertical"
            size_hint_x: 1
            adaptive_height: True
            pos_hint: {"center_x": .5, "center_y": .5}
            md_bg_color: app.theme_cls.bg_light

            MDBoxLayout:
                id: table_box
                size_hint_x: 1
                adaptive_height: True
                pos_hint: {"center_x": .5, "center_y": .5}
                md_bg_color: app.theme_cls.bg_light

            MDBoxLayout:
                orientation: "vertical"
                adaptive_height: True
                pos_hint: {"center_x": .5, "center_y": .5}
                md_bg_color: app.theme_cls.bg_light

                MDBoxLayout:
                    orientation: "horizontal"
                    adaptive_height: True
                    pos_hint: {"center_x": .5, "center_y": .5}
                    md_bg_color: app.theme_cls.bg_light

                    MDFillRoundFlatButton:
                        font_style: "Button"
                        text: "Back"
                        size_hint_x: .5
                        size_hint_y: None
                        pos_hint: {"center_x": .25, "center_y": .5}
                        md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                        on_press: root.current = 'processing'

                    MDFillRoundFlatButton:
                        font_style: "Button"
                        text: "Collect"
                        size_hint_x: .5
                        size_hint_y: None
                        pos_hint: {"center_x": .75, "center_y": .5}
                        md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                        on_press: app.callback_button_collect()

    MDScreen:
        name: 'check'
        md_bg_color: app.theme_cls.bg_light
        on_enter:
            image4.anim_delay = 1/30
            image4.anim_loop = 1

        MDFloatLayout:

            Image:
                id: image4
                source: "successful.gif"
                pos_hint: {"x": 0, "y": 0.1}

            MDLabel:
                font_style: "H6"
                text: "Finished!"
                pos_hint: {"center_x": .5, "center_y": .9}
                valign: 'middle'
                halign: 'center'

            MDFillRoundFlatButton:
                font_style: "Button"
                text: "Exit"
                size_hint_x: .75
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .14}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press: app.stop()

            MDFillRoundFlatButton:
                font_style: "Button"
                text: "Upload"
                size_hint_x: .25
                size_hint_y: None
                pos_hint: {"center_x": .5, "center_y": .05}
                md_bg_color: (138.0/255.0,161.0/255.0,107.0/255.0,.5)
                on_press:
                    root.transition.direction = 'right'
                    app.uploading()